<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pole Star Defense - Email Template Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .email-template {
            font-family: Arial, sans-serif;
            font-size: 14px;
            line-height: 1.5;
            max-width: 8.5in;
            margin: 0 auto;
            padding: 1in;
            background: white;
            color: black;
            position: relative;
        }
        
        .email-watermark {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            opacity: 0.1;
            z-index: 1;
            width: 200px;
            pointer-events: none;
        }
        
        .header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 30px;
            border-bottom: 1px solid #e5e5e5;
            padding-bottom: 15px;
        }
        
        .address {
            text-align: right;
            font-size: 12px;
            line-height: 1.4;
        }
        
        .content {
            margin-bottom: 40px;
        }
        
        @media print {
            .no-print { display: none !important; }
            body { margin: 0; }
            .email-template { 
                box-shadow: none; 
                margin: 0; 
                padding: 0.5in;
            }
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- Header -->
    <header class="bg-white shadow-sm border-b no-print">
        <div class="max-w-7xl mx-auto px-4 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-teal-600 rounded-lg flex items-center justify-center">
                        <span class="text-white font-bold text-lg">P</span>
                    </div>
                    <div>
                        <h1 class="text-xl font-bold text-gray-900">Pole Star Defense</h1>
                        <p class="text-sm text-gray-500">Email Template Generator</p>
                    </div>
                </div>
                <div class="flex space-x-4">
                    <button onclick="exportEmail()" class="bg-teal-600 hover:bg-teal-700 text-white px-4 py-2 rounded-lg">
                        Export Email
                    </button>
                    <button onclick="window.print()" class="border border-gray-300 text-gray-700 hover:bg-gray-50 px-4 py-2 rounded-lg">
                        Print
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-4 py-8">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <!-- Form -->
            <div class="bg-white rounded-lg shadow p-6 no-print">
                <h2 class="text-xl font-semibold mb-6">Email Template Form</h2>
                
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Date</label>
                        <input type="date" id="emailDate" class="w-full border border-gray-300 rounded-md px-3 py-2" onchange="updatePreview()">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Client Name</label>
                        <input type="text" id="clientName" placeholder="Enter client name" class="w-full border border-gray-300 rounded-md px-3 py-2" onchange="updatePreview()">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Subject</label>
                        <input type="text" id="subject" placeholder="Enter email subject" class="w-full border border-gray-300 rounded-md px-3 py-2" onchange="updatePreview()">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Type</label>
                        <select id="emailType" class="w-full border border-gray-300 rounded-md px-3 py-2" onchange="updatePreview()">
                            <option>System Issue / Informational Report</option>
                            <option>Maintenance Notification</option>
                            <option>Security Update</option>
                            <option>General Communication</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Content</label>
                        <textarea id="content" rows="6" placeholder="Enter your message content..." class="w-full border border-gray-300 rounded-md px-3 py-2" onchange="updatePreview()"></textarea>
                    </div>
                    
                    <div class="flex items-center space-x-4">
                        <label class="flex items-center">
                            <input type="checkbox" id="includeWatermark" class="mr-2" onchange="updatePreview()">
                            <span class="text-sm text-gray-700">Include watermark</span>
                        </label>
                    </div>
                </div>
            </div>

            <!-- Preview -->
            <div class="bg-white rounded-lg shadow p-6">
                <h2 class="text-xl font-semibold mb-6 no-print">Live Preview</h2>
                
                <div id="emailPreview" class="email-template border">
                    <!-- Watermark -->
                    <img id="watermark" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOYAAAAtCAYAAAC6RRfMAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAABpvSURBVHhe7V0LmFxFlR7ATN+qO5OHiPgAwkIwOJjM9K26der2TDKJkhhFEJCIL8hM90wIkYfgp7u6migIGDLTnReviKIuCptdXYnoAhFhRZCVYKIQ0PAIFE8CCQz3TN5XL9T95Hu6tsz3ZPJgKb/7zvfQG51Vd269dfj1DmnaiiH9vJFJKkNbfVxeXpdk2gYLeXba4YJvV1tx/anO+b2dqXu7O1O/S2X7nD3ret0e9PJXdl02/r+dOq6XerkzO3fnztG/20loJa08B0oEykqZMrgTkJPc8BYuPJwEuenUzvRWdyGFQoTKdOWn60ZP97Qixk2SEnqm+AkyuT51HaWGzasJgweogzWEiYfMhisNpiTMTh8KibEv9RMmBXTs4jAYaMAJqs+o7/TgYoNnfgdsQy90EgccwwxLfsz6purPESSWnIOEeIYPWmliPGWE/D77M+7DLGhrY45Z5rc+UD9yfaRep4KlEt3aCL2EC7+RLlcUMfYyXq+5SKbbj+hL9PR1ZdO9bor5rq5dLI3l0luy6WT27PdyZy7/ALXvf5C11021+3LpNzd6dSDvYvnnDdUghJLXEEZ7KG241KRcCmHG/U0wwHC4S4TmiParUKxHZcwsb2uqekovYwDxjGSECY+Tm35E8KgV7WJXr4mBocdxJY/NBnMGJCgs2cfQbn8ajl5Viyi2SVcXoFl6MVGwRscZF9+XUyRcEncvrqGsVF6+kpgWvIzlMnXh/SeTO4lltxAmfO1eoCTCjKmHDP0Mw0662CC6QLBRmLwGLXEaQUZl4HXu5Jn9GWSz/SnO17rS3fck063d/ek2z/fm0md25dJnZvtTl2U7Wpb35sudMe7+8AQ==" alt="Watermark" style="display: none; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); opacity: 0.1; z-index: -1; width: 200px;">
                    
                    <!-- Header -->
                    <div class="header">
                        <div>
                            <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOYAAAAtCAYAAAC6RRfMAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAABpvSURBVHhe7V0LmFxFlR7ATN+qO5OHiPgAwkIwOJjM9K26der2TDKJkhhFEJCIL8hM90wIkYfgp7u6migIGDLTnReviKIuCptdXYnoAhFhRZCVYKIQ0PAIFE8CCQz3TN5XL9T95Hu6tsz3ZPJgKb/7zvfQG51Vd269dfj1DmnaiiH9vJFJKkNbfVxeXpdk2gYLeXba4YJvV1tx/anO+b2dqXu7O1O/S2X7nD3ret0e9PJXdl02/r+dOq6XerkzO3fnztG/20loJa08B0oEykqZMrgTkJPc8BYuPJwEuenUzvRWdyGFQoTKdOWn60ZP97Qixk2SEnqm+AkyuT51HaWGzasJgweogzWEiYfMhisNpiTMTh8KibEv9RMmBXTs4jAYaMAJqs+o7/TgYoNnfgdsQy90EgccwwxLfsz6purPESSWnIOEeIYPWmliPGWE/D77M+7DLGhrY45Z5rc+UD9yfaRep4KlEt3aCL2EC7+RLlcUMfYyXq+5SKbbj+hL9PR1ZdO9bor5rq5dLI3l0luy6WT27PdyZy7/ALXvf5C11021+3LpNzd6dSDvYvnnDdUghJLXEEZ7KG241KRcCmHG/U0wwHC4S4TmiParUKxHZcwsb2uqekovYwDxjGSECY+Tm35E8KgV7WJXr4mBocdxJY/NBnMGJCgs2cfQbn8ajl5Viyi2SVcXoFl6MVGwRscZF9+XUyRcEncvrqGsVF6+kpgWvIzlMnXh/SeTO4lltxAmfO1eoCTCjKmHDP0Mw0662CC6QLBRmLwGLXEaQUZl4HXu5Jn9GWSz/SnO17rS3fck063d/ek2z/fm0md25dJnZvtTl2U7Wpb35sudMe7+8AQ==" alt="Pole Star Defense" style="height: 25px;">
                        </div>
                        <div class="address">
                            <strong>Pole Star Defense</strong><br>
                            450 8th Ave SE<br>
                            St. Petersburg, FL 33701 USA
                        </div>
                    </div>

                    <!-- Title -->
                    <div style="text-align: center; margin-bottom: 20px;">
                        <h1 style="font-size: 14px; font-weight: bold; margin: 0 0 10px 0;">
                            "Pole Star Defense â€“ External Communication"
                        </h1>
                        <div style="font-size: 12px; margin: 0;" id="previewType">
                            System Issue / Informational Report
                        </div>
                    </div>
                    
                    <!-- Content -->
                    <div class="content" style="position: relative; z-index: 2;">
                        <p style="margin: 0 0 12px 0;"><strong>Date:</strong> <span id="previewDate">[Date]</span></p>
                        <p style="margin: 0 0 12px 0;"><strong>Subject:</strong> <span id="previewSubject">[Subject]</span></p>
                        <p style="margin: 0 0 24px 0;"><strong>To:</strong> <span id="previewClient">[Client Name]</span></p>
                        
                        <p style="margin: 0 0 16px 0;">Dear <span id="previewClientName">[Client Name]</span>,</p>
                        
                        <p style="margin: 0 0 16px 0;">We would like to inform you about the following system update / issue / report:</p>
                        
                        <div id="previewContent" style="margin: 0 0 16px 0;">[Your message content will appear here]</div>
                        
                        <p style="margin: 0 0 24px 0;">We remain committed to transparency and operational excellence. Please contact us if you require further details or assistance.</p>

                        <p style="margin: 0 0 6px 0;">Sincerely,</p>
                        <p style="margin: 0 0 6px 0;">Pole Star Defense Team</p>
                        <p style="margin: 0 0 24px 0;">
                            <a href="mailto:Ops.Center@PoleStarDefense.com" style="color: #0066cc; text-decoration: underline;">
                                Ops.Center@PoleStarDefense.com
                            </a>
                        </p>
                    </div>
                    
                    <!-- Footer Info Box -->
                    <div style="margin-top: 40px; padding: 20px; background-color: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                            <h3 style="margin: 0; font-size: 16px; font-weight: 600; color: #0a3b3a;">Contact Information</h3>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; font-size: 13px; color: #374151;">
                            <div>
                                <p style="margin: 0 0 8px 0;"><strong>Operations Center:</strong></p>
                                <p style="margin: 0 0 4px 0;">Email: <a href="mailto:Ops.Center@PoleStarDefense.com" style="color: #0066cc;">Ops.Center@PoleStarDefense.com</a></p>
                                <p style="margin: 0 0 4px 0;">Phone: (555) 123-POLE</p>
                                <p style="margin: 0;">Available 24/7 for critical issues</p>
                            </div>
                            
                            <div>
                                <p style="margin: 0 0 8px 0;"><strong>Business Hours:</strong></p>
                                <p style="margin: 0 0 4px 0;">Monday - Friday: 8:00 AM - 6:00 PM EST</p>
                                <p style="margin: 0 0 4px 0;">Emergency Support: 24/7</p>
                                <p style="margin: 0;">Response Time: Within 2 hours</p>
                            </div>
                        </div>
                        
                        <div style="margin-top: 16px; padding-top: 16px; border-top: 1px solid #e5e7eb; font-size: 12px; color: #6b7280; text-align: center;">
                            <p style="margin: 0;">This communication contains confidential and proprietary information. Please handle accordingly.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script>
        // Set today's date by default
        document.getElementById('emailDate').value = new Date().toISOString().split('T')[0];
        
        function updatePreview() {
            const date = document.getElementById('emailDate').value;
            const clientName = document.getElementById('clientName').value;
            const subject = document.getElementById('subject').value;
            const content = document.getElementById('content').value;
            const includeWatermark = document.getElementById('includeWatermark').checked;
            
            // Update preview fields
            document.getElementById('previewDate').textContent = date || '[Date]';
            document.getElementById('previewSubject').textContent = subject || '[Subject]';
            document.getElementById('previewClient').textContent = clientName || '[Client Name]';
            document.getElementById('previewClientName').textContent = clientName || '[Client Name]';
            document.getElementById('previewContent').innerHTML = content ? content.replace(/\n/g, '<br>') : '[Your message content will appear here]';
            document.getElementById('previewType').textContent = document.getElementById('emailType').value;
            
            // Show/hide watermark
            document.getElementById('watermark').style.display = includeWatermark ? 'block' : 'none';
            
            // Save to localStorage
            localStorage.setItem('psd-email-data', JSON.stringify({
                date, clientName, subject, content, includeWatermark
            }));
        }
        
        function exportEmail() {
            const emailElement = document.getElementById('emailPreview');
            const emailContent = emailElement.outerHTML;
            const clientName = document.getElementById('clientName').value || 'template';
            const date = document.getElementById('emailDate').value || 'today';
            
            const fullHtml = `<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Pole Star Defense Email</title>
    <style>
        @page { size: letter; margin: 1in; }
        body { margin: 0; font-family: Arial, sans-serif; }
        .email-template { font-size: 14px; line-height: 1.5; }
        .header { display: flex; justify-content: space-between; margin-bottom: 30px; border-bottom: 1px solid #e5e5e5; padding-bottom: 15px; }
        .address { text-align: right; font-size: 12px; }
        .content { margin-bottom: 40px; }
    </style>
</head>
<body>
    ${emailContent}
</body>
</html>`;
            
            const blob = new Blob([fullHtml], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `email_${clientName}_${date}.html`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }
        
        // Load saved data on page load
        window.onload = function() {
            const saved = localStorage.getItem('psd-email-data');
            if (saved) {
                const data = JSON.parse(saved);
                document.getElementById('emailDate').value = data.date || '';
                document.getElementById('clientName').value = data.clientName || '';
                document.getElementById('subject').value = data.subject || '';
                document.getElementById('content').value = data.content || '';
                document.getElementById('includeWatermark').checked = data.includeWatermark || false;
                updatePreview();
            } else {
                updatePreview();
            }
        };
    </script>
</body>
</html>